\chapter[Metodologia]{Metodologia}

Neste capítulo é discutido como o projeto será desenvolvido, especificamente
para cumprir com os objetivos definidos na Seção \ref{sec:objective}. Para esse fim
é definido um escopo para o projeto, que consiste na especificação da linguagem FRED e 
como serão feitas as implementações e a coleta de resultados.

\section{Solução proposta}
\label{sec:solution}

É necessário definir o escopo deste projeto. A solução a ser construída consiste em implementar a linguagem FRED.
Portanto é necessário antes definir esta linguagem.

O FRED (Flexible REpresentation of Data) é uma notação criada para a troca de dados. Os
objetivos dela são:

\begin{itemize}
    \item Facilidade para ler e escrever por humanos
    \item Facilidade para construir \textit{parsers}
    \item Suportar extensão atráves de tags
    \item Permitir a entrada de metadados
\end{itemize}

O FRED possui um modelo de dados comos tipos tradicionais encontrados em JSON, 
porém com algumas adições e outras abstrações inspiradas em XML e outras notações.

Existe o valor representando \textit{null} e como esperado a notação é  \textbf{null}. Booleanos
também são representados como esperado \textbf{true} e \textbf{false}.

Strings são representadas com aspas duplas como em \textbf{"String that is valid"} 
e aceitam qualquer caracter unicode exceto os que devem ser \textit{escaped}.  
que são:

\begin{center}    
    \textbackslash b, \textbackslash t, \textbackslash n, \textbackslash f, 
    \textbackslash r, \textbackslash ", \textbackslash \textbackslash , \textbackslash xXX, 
    \textbackslash uXXXX, \textbackslash UXXXXXXXX
\end{center}

Os números podem ser tanto \textit{floats} como inteiros e existe notação especial para
entrar números em diferentes bases (binário, octal, hexadecimal). Exemplo de inteiros 
são \textbf{42, -42, 1\_000\_000, 0xBEEF\_00E9, 0o7823, 0b1010} e exemplos de números do tipo
float são \textbf{42.12, -42.12, 4.32e-19, -2E-2}.

Um tipo que não existe em JSON mas está definido na spec do FRED são os DateTime.
Datas e Horas podem ser representadas em FRED. Utilizando uma notação parecida com
a RFC 3339.

Para Datas não associadas a horas e nem a fusos, a representação é \textbf{YYYY-MM-DD}.

Para representar Tempo sem estar associado a datas nem a fusos a representação é \textbf{HH:MM:SS.SS}.

Datas com Horas podem ser representadas sem estar associadas a fusos horários. 
A notação é \textbf{YYYY-MM-DDTHH:MM:SS.SS} e o \textbf{T} pode ser substituido por \textbf{\_}.

Por fim pode-se representar Datas com Horas e fusos. Utilizando a notação anterior e adicionando
ou um \textbf{Z} para representar o fuso UTC ou \textbf{+-HH:MM} representando um fuso.

Outro tipo de dado que não tem especificação em JSON porém tem em FRED são os blobs binários. Eles
representam dados binários codificados de alguma forma. A notação é \textbf{\#"rawdata"}.

\textit{Symbols} são muito conhecidos em Ruby. Eles podem ser representados em FRED usando o caracter
\textbf{\$}. Exemplo \textbf{\$var1}.

A linguagem FRED também permite a representação de listas, utilizando uma notação parecido com JSON.
Por exemplo, \textbf{[1 2 3]}. Vale notar que o separador é pelo menos um espaço e que vírgulas em FRED
são consideradas espaço em branco. Logo, listas também podem ser escritas desta forma \textbf{[1, 2, 3]}.

Também é possível representar dicionários em FRED. A sintaxe é muito parecida com JSON. 
Exemplo de dicionário em FRED em \ref{lst:fredobj}. Basicamente é um conjunto de pares 
chave e valor separados por pelo menos um espaço.

\begin{lstlisting}[caption=Exemplo de dicionário em FRED,label={lst:fredobj}]
{
    foo : "bar"
    `test foo` : "bar"
}
\end{lstlisting}

Existem duas abstrações em FRED que não existem em JSON. São as \textit{tags} e a possibilidade de entrada 
de metadados.

\begin{lstlisting}[caption=Exemplo de dicionário com Tag em FRED,label={lst:fredtagobj}]
person {
    name: "eric"
    age: 25
}
\end{lstlisting}
    
As \textit{tags} são uma maneira de indicar mais significado semântico para os elementos em FRED. E permite
mecanismos de verificação e extensão do modelo de dados base. No exemplo \ref{lst:fredtagobj} 
temos um dicionário com tag em FRED.

Quando se tem elementos com tag em FRED é possível também entrar metadados sobre este elemento 
utilizando uma notação específica. A sintaxe consiste de entrar atributos dentro de parentêses. 
Temos como exemplo de documento FRED com tag e metadados: \textbf{phone (country="Brazil") "32131123"}.

Também é possível representar tags e metadados sem estar associado a nenhum elemento. 
Por exemplo: \textbf{(tag attr=1)}.

FRED tem suporte para \textit{streaming}. Em \ref{lst:fredstream} está
um exemplo de documento FRED para \textit{streaming}.

\begin{lstlisting}[caption=Exemplo de documento com streaming em FRED,label={lst:fredstream}]
---
person "Jhon"
---
person "Mary"
---
person "James"
---
\end{lstlisting}

A gramática do FRED foi especificada formalmente no Apêndice \ref{sec:fredgrammar}.
Ela foi desenvolvida de forma a ser fácil de criar \textit{parsers} LL(1). Toda essa especificação
está divulgada de maneira aberta no endereço \url{https://github.com/fred-format/fred}.
 
\section{Atividades do Projeto}

Com a especificação formal da linguagem FRED, é necessário 
descrever o escopo do projeto. As implementações serão feitas 
em duas linguagens: Haskell e JavaScript. Também será discutida
a linguagem FRED e como ela se relaciona com outros formatos.

As atividades a serem feitas nesse projeto são:

\begin{itemize}
    \item Implementação do FRED em Haskell
    \begin{itemize}
        \item Decidir como o FRED será implementado em Haskell.
        \item Implementar a linguagem em Haskell.
        \item Documentar a implementação.
        \item Distribuir a implementação.
    \end{itemize}
    \item Implementação do FRED em JavaScript
    \begin{itemize}
        \item Decidir como o FRED será implementado em JavaScript.
        \item Implementar a linguagem em JavaScript.
        \item Documentar a implementação.
        \item Distribuir a implementação.
    \end{itemize}
\end{itemize}

Junto com a implementação da linguagem será desenvolvida uma suíte de testes para garantir 
que as implementações de FRED estão conforme a especificação. As atividades a serem
feitas nessa etapa são:

\begin{itemize}
    \item Implementação da Suíte de Testes
    \begin{itemize}
        \item Estudar como construir testes para garantir a especificação.
        \item Construir uma suíte de testes capaz de testar implementações de FRED.
        \item Documentar a suíte de testes.
    \end{itemize}
\end{itemize}

Por fim será feito uma análise da linguagem FRED. Essa análise consiste 
em uma discussão sobre a linguagem e também será feito alguma comparação
com linguagens semelhantes a partir de métricas a serem definidas.

As  atividades a serem desenvolvidas nessa etapa são:

\begin{itemize}
    \item Discutir as características diferenciais da linguagem FRED.
    \item Coletar dados e comparar FRED com linguagens semelhantes.
\end{itemize}
